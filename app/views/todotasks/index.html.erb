<h1><%= t('view.todotasks.index') %></h1>
<%= link_to "終了期限でソートする", todotasks_path(sort_expired: "true") %>
<%= form_with(model: Todotask.new, url: todotasks_path, local:true, method: :get) do |f| %>
  <%= f.label :name %>
  <%= f.text_field :name %>

  <%= f.label :status %>
  <%= f.select :status,[["未着手",1], ["着手", 2], ["完了", 3]], include_blank: true %>

  <%= f.submit %>
<% end %>
<table>
  <tr>
    <th><%= t('view.todotasks.name') %></th>
    <th><%= t('view.todotasks.content') %></th>
    <th><%= t('view.todotasks.status') %></th>
    <th><%= t('view.todotasks.deadline') %></th>
    <th><%= t('view.todotasks.priority') %></th>
    <th><%= t('view.todotasks.author') %></th>
  </tr>
  <% @todotasks.each do |task| %>
      <tr>
        <td><%= task.name %></td>
        <td>
          <% if task.content.nil? %>
            から
          <% else %>
            <%= task.content %>
          <% end %>
        </td>
        <td>
          <% if task.status == 1 %>
            <%= t('view.todotasks.status_1') %>
          <% elsif task.status == 2 %>
            <%= t('view.todotasks.status_2') %>
          <% else %>
            <%= t('view.todotasks.status_3') %>
          <% end %>
        </td>
        <td><%= task.deadline.year %>-<%= task.deadline.month %>-<%= task.deadline.day %></td>
        <td>
          <% if task.priority == 1 %>
            <%= t('view.todotasks.priority_high') %>
          <% elsif task.priority == 2 %>
            <%= t('view.todotasks.priority_middle') %>
          <% else %>
            <%= t('view.todotasks.priority_low') %>
          <% end %>
        </td>
        <td>
          <% if task.user_id.present? %>
            <%= task.user.name %>
          <% else %>

          <% end %>
          </td>
        <td><%= link_to t('view.show'), todotask_path(task.id) %></td>
        <td><%= link_to t('view.edit'), edit_todotask_path(task.id) %></td>
        <td><%= link_to t('view.delete'), todotask_path(task.id), method: :delete %></td>
      </tr>
  <% end %>
</table>
